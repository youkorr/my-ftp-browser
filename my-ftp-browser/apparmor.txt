#include <tunables/global>

profile my-ftp-browser flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/python>
  
  # Permissions nécessaires pour le serveur FTP
  network inet tcp,
  network inet udp,

  # Permissions pour les fichiers système
  /bin/** ix,
  /usr/bin/** rix,
  /sbin/** ix,
  /usr/sbin/** ix,
  
  # Permissions pour Python et autres exécutables
  /usr/local/bin/** ix,
  /usr/local/lib/** rm,
  /usr/local/lib64/** rm,
  
  # Permissions pour les bibliothèques
  /lib/** rm,
  /usr/lib/** rm,
  /lib64/** rm,
  /usr/lib64/** rm,
  
  # Permissions pour les fichiers temporaires
  /tmp/** rwk,
  /var/tmp/** rwk,
  
  # Permissions pour les fichiers de l'addon
  /data/** rw,
  /share/** rw,
  /ssl/** r,
  /media/** rw,

  # Permissions spécifiques pour /run.sh
  /run.sh rwix,
  /usr/bin/bashio ix,
  /usr/lib/bashio/** r,


  # Permissions pour les fichiers de l'application
  /usr/share/ftpbrowser/** rw,
  /etc/services.d/** rwix,
  
  # Permissions pour le journal
  /dev/stdout rw,
  /dev/stderr rw,
  /dev/stdin r,
  
  # Nécessaire pour le système
  capability net_bind_service,
  capability dac_override,
}
