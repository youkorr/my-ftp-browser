#include <tunables/global>

profile my-ftp-browser flags=(attach_disconnected,mediate_deleted) {
  # Abstractions de base
  #---------------------
  # Accès de base au système et à Python
  #---------------------
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/python>
  
  # Réseau
  network inet tcp,
  network inet udp,

  # Exécution des binaires système
  /bin/** ix,
  /sbin/** ix,
  /usr/sbin/** ix,

  # Exécution des binaires utilisateurs
  /usr/bin/** ix,
  /usr/local/bin/** ix,

  # Permissions spécifiques pour les exécutables nécessaires
  /usr/bin/with-contenv rixm,
  /init ix,
  /command/** ix,
  /package/** ix,
  /run/s6*/** ix,
  /run/service/** ix,
  /usr/bin/bashio ix,
  /usr/lib/bashio/** r,

  # Bibliothèques partagées
  /usr/local/lib/** rm,
  /usr/local/lib64/** rm,
  /lib/** rm,
  /usr/lib/** rm,
  /lib64/** rm,
  /usr/lib64/** rm,

  # Fichiers temporaires
  /tmp/** rwk,
  /var/tmp/** rwk,

  # Dossiers de l'addon
  /data/** rw,
  /share/** rw,
  /ssl/** r,
  /media/** rw,

  # Fichiers de configuration et scripts
  /run.sh rwix,
  /usr/share/ftpbrowser/** rw,
  /etc/services.d/** rwix,

  # Journalisation
  /dev/stdout rw,
  /dev/stderr rw,
  /dev/stdin r,

  # Pour s6-overlay (gestionnaire de services)
  /var/run/s6/** rwk,

  # Permissions générales nécessaires
  capability net_bind_service,
  capability dac_override,
}

